{"ts":1380457993824,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"<!DOCTYPE html>\n<html>\n<head>\n    <title>Kendo Sushi</title>\n    <link href=\"http://cdn.kendostatic.com/2012.3.1114/styles/kendo.common.min.css\" rel=\"stylesheet\">\n    <link href=\"http://cdn.kendostatic.com/2012.3.1114/styles/kendo.default.min.css\" rel=\"stylesheet\">\n    <link href=\"http://cdn.kendostatic.com/2012.3.1114/styles/kendo.mobile.all.min.css\" rel=\"stylesheet\">\n    <script src=\"http://code.jquery.com/jquery-1.8.2.min.js\"></script>\n    <script src=\"http://cdn.kendostatic.com/2012.3.1114/js/kendo.all.min.js\"></script>\n    <link rel=\"stylesheet\" href=\"content/css/style.css\">\n</head>\n<body>\n    <div data-role=\"layout\" data-id=\"default\">\n        <header data-role=\"header\">\n        <div data-role=\"navbar\">\n            <span data-role=\"view-title\"></span>\n            <a class=\"about-button\" data-align=\"right\" href=\"content/about.html\" data-role=\"button\">About</a>\n        </div>\n        </header>\n\n        <footer data-role=\"footer\" data-id=\"default\">\n        <div data-role=\"tabstrip\">\n            <a href=\"#index\" data-icon=\"home\">Home</a>\n            <a href=\"#menu\" data-icon=\"organize\">Our menu</a>\n            <a href=\"#cart\" data-icon=\"cart\">Cart</a>\n            <a href=\"#account\" data-icon=\"contacts\">Account</a>\n        </div>\n        </footer>\n    </div>\n\n    <div data-title=\"Kendo sushi\" data-role=\"view\" id=\"index\" data-url=\"/\" data-layout=\"default\" data-show=\"showMenuView\">\n        <ul id=\"featured\"\n            class=\"item-list\"\n            data-role=\"listview\"\n            data-template=\"menuTemplate\"\n            data-source=\"featured\"\n        ></ul>\n    </div>\n\n    <div data-role=\"view\" id=\"menu\" data-layout=\"default\" data-title=\"Menu\" data-show=\"showMenuView\">\n        <ul id=\"menuList\"\n            class=\"item-list\"\n            data-role=\"listview\"\n            data-template=\"menuTemplate\"\n            data-source=\"ds\"\n        ></ul>\n    </div>\n\n    <div data-role=\"view\" id=\"cart\" data-layout=\"default\" data-title=\"Cart\">\n        <h2 id=\"total\"></h2>\n        <img src=\"content/images/sad.png\" id=\"empty-icon\">\n        <a id=\"checkout\" data-click=\"checkout\" class=\"red-button\" href=\"#done\" data-role=\"button\">Checkout</a>\n        <ul id=\"cartList\" \n            class=\"item-list\"\n            data-template=\"cartItemTemplate\"\n            data-source=\"cartDataSource\"\n            data-role=\"listview\"\n            data-style=\"inset\"\n        ></ul>\n    </div>\n\n    <div data-role=\"view\" id=\"account\" data-layout=\"default\" data-title=\"My Account\">\n        <ul data-role=\"listview\" data-style=\"inset\" data-type=\"group\">\n            <li>\n                Account\n                <ul>\n                    <li>Username<span class=\"list-item-data\">kendoSushi</span></li>\n                    <li>Email<span class=\"list-item-data\">sushi@kendoui.com</span></li>\n                </ul>\n            </li>\n            <li>\n                Notifications\n                <ul>\n                    <li>New products<input type=\"checkbox\" data-role=\"switch\" /></li>\n                    <li>Exclusive promos<input type=\"checkbox\" data-role=\"switch\" checked=\"checked\" /></li>\n                </ul>\n            </li>\n        </ul>\n    </div>\n\n    <div data-role=\"view\" id=\"done\" data-transition=\"zoom\">\n        <header data-role=\"header\"> \n            <div data-role=\"navbar\"> \n                <span data-role=\"view-title\">Done!</span> \n            </div>\n        </header>\n        <div data-role=\"content\" class=\"km-insetcontent\">\n            <img src=\"content/images/happy.png\" id=\"done-icon\">\n            <h2>Thanks for shopping!</h2>\n            <h3>Your sushi is on the way.</h3>\n            <a id=\"done-button\" href=\"#cart\" data-role=\"button\">Done</a>\n        </div>\n    </div>\n\n    <div data-role=\"view\" id=\"details\" data-transition=\"slide\" data-layout=\"default\" data-show=\"showDetailsView\">\n        <header data-role=\"header\">\n            <div data-role=\"navbar\">\n                <a data-role=\"backbutton\" data-align=\"left\">Back</a>\n                <span data-role=\"view-title\">Item</span>\n            </div>\n        </header>\n\n        <div data-role=\"content\">\n        </div>\n    </div>\n\n    <script id=\"menuTemplate\" type=\"text/x-kendo-template\">\n        <a data-role=\"button\"\n            data-click=\"addToCartFromList\"\n            data-item-id=\"#:id#\"\n            href=\"\\\\#\">#:kendo.toString(price, \"c\")#</a>\n        <a\n            class=\"details-link\"\n            data-role=\"listview-link\"\n            href=\"\\#details?id=#:id#\">\n            <img src=\"content/images/75/#:image#\" />\n            <h2>#:name#</h2>\n            <span class=\"added\"#= cartDataSource.get(id) ? \"\" : 'style=\"display: none\"' #>Item added to cart</span>\n        </a>\n    </script>\n\n    <script id=\"cartItemTemplate\" type=\"text/x-kendo-template\">\n        <a\n            class=\"red-button\"\n            data-click=\"removeItemFromList\"\n            data-item-id=\"#:id#\"\n            data-role=\"button\"\n            href=\"\\\\#\">&nbsp;&\\\\#x2716;&nbsp;</a>\n        <a\n            class=\"details-link\"\n            data-role=\"listview-link\"\n            href=\"\\#details?id=#:id#\">\n            <img src=\"content/images/75/#:image#\" />\n            <h2>#:name#</h2>\n            <span class=\"price\">#:kendo.toString(price, \"c\")#</span>\n        </a>\n    </script>\n\n    <script id=\"detailTemplate\" type=\"text/x-kendo-template\">\n        <aside>\n        <img src=\"content/images/200/#:image#\" />\n        <span class=\"price\">#:kendo.toString(price, \"c\")#</span>\n        <a data-role=\"button\" data-item-id=\"#:id#\" id=\"add-to-cart\" data-click=\"addToCartFromDetail\">Order</a>\n        </aside>\n        <h2>#:name#</h2>\n        <p>#:description#</p>\n        <span class=\"added\"#= cartDataSource.get(id) ? \"\" : 'style=\"display: none\"' #>Item added to cart</span>\n    </script>\n\n    <script>\n        var app;\n\n        var schema = {model: {}};\n\n        var ds = new kendo.data.DataSource({\n            schema: schema,\n            transport: { read: { url: \"content/menu.json\", dataType: \"json\" } },\n            group: \"category\",\n            error: function() { console.log(arguments); }\n        });\n\n        var cartDataSource = new kendo.data.DataSource({\n            data: [],\n            schema: schema,\n            aggregate: [{ field: \"price\", aggregate: \"sum\" }]\n        });\n\n        //cartDataSource.read();\n\n        cartDataSource.bind(\"change\", function() {\n            var emptyCart = cartDataSource.aggregates().price === undefined;\n\n            if (emptyCart) {\n                $(\"#total\").html(kendo.toString(0, \"c\"));\n                } else {\n                $(\"#total\").html(kendo.toString(cartDataSource.aggregates().price.sum, \"c\"));\n            }\n\n            $(\"#cart .km-content\").toggleClass(\"km-empty\", emptyCart);\n        });\n\n        var featured = new kendo.data.DataSource({\n            schema: schema,\n            filter: {\n                field: \"featured\",\n                operator: \"eq\",\n                value: true\n            }\n        });\n\n        ds.bind(\"change\", function() {\n            featured.data(ds.data());\n        });\n\n        ds.fetch();\n\n        var itemDetailsTemplate = kendo.template($(\"#detailTemplate\").text());\n\n        function addToCartFromList(e) {\n            var button = e.button,\n                item = ds.get(button.data(\"itemId\"));\n\n            cartDataSource.add(item);\n            button.parent().find(\".added\").show();\n\n            e.preventDefault();\n        }\n\n        function addToCartFromDetail(e) {\n            var button = e.button,\n                item = ds.get(button.data(\"itemId\"));\n\n            cartDataSource.add(item);\n            button.parent().parent().find(\".added\").show();\n        }\n\n        function removeItemFromList(e) {\n            var item = ds.get(e.button.data(\"itemId\")),\n                currentView = app.view();\n\n            cartDataSource.remove(item);\n            currentView.scroller.reset();\n            e.preventDefault();\n        }\n\n        function checkout() {\n            setTimeout(function () { cartDataSource.data([]) }, 400);\n        }\n\n        function showDetailsView(e) {\n            var view = e.view;\n\n            ds.fetch(function() {\n                item = ds.get(view.params.id);\n                view.scrollerContent.html(itemDetailsTemplate(item));\n                kendo.mobile.init(view.content);\n            });\n        }\n\n        function showMenuView(e) {\n            e.view.content.find(\".item-list\").data(\"kendoMobileListView\").refresh();\n        }\n\n        app = new kendo.mobile.Application($(document.body), { transition: \"slide\" });\n    </script>\n</body>\n</html>\n\n"]],"start1":0,"start2":0,"length1":0,"length2":8556}]],"length":8556}
{"contributors":[],"silentsave":false,"ts":1380458782577,"patch":[[{"diffs":[[0,"ef=\""],[-1,"http://cdn.kendostatic.com/2012.3.1114/style"],[1,"content/cs"],[0,"s/ke"]],"start1":73,"start2":73,"length1":52,"length2":18}]],"length":8522,"saved":false}
{"ts":1380458876624,"patch":[[{"diffs":[[0,"ef=\""],[-1,"http://cdn.kendostatic.com/2012.3.1114/style"],[1,"content/cs"],[0,"s/ke"]],"start1":141,"start2":141,"length1":52,"length2":18},{"diffs":[[0,"ef=\""],[-1,"http://cdn.kendostatic.com/2012.3.1114/style"],[1,"content/cs"],[0,"s/ke"]],"start1":210,"start2":210,"length1":52,"length2":18},{"diffs":[[0,"rc=\""],[-1,"http://code.jquery.com"],[1,"content/lib"],[0,"/jquery"],[-1,"-1.8.2"],[0,".min"]],"start1":283,"start2":283,"length1":43,"length2":26},{"diffs":[[0,"rc=\""],[-1,"http://cdn.kendostatic.com/2012.3.1114/js"],[1,"content/lib"],[0,"/ken"]],"start1":337,"start2":337,"length1":49,"length2":19}]],"length":8407,"saved":false}
